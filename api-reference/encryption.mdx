---
title: 'Encryption'
description: 'Encrypt sensitive data using CryptoLay manifests'
---

# Encryption API

The encryption endpoint allows you to encrypt sensitive data using predefined manifests. Each manifest defines which fields should be encrypted and how.

## Encrypt Data

<RequestExample>

```bash
curl -X POST https://api.cryptolay.com.br/api/encrypt \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "manifest_id": "manifest-uuid",
    "data": {
      "email": "user@example.com",
      "phone": "+1234567890",
      "ssn": "123-45-6789"
    }
  }'
```

</RequestExample>

<ResponseExample>

```json
{
  "encrypted_data": {
    "email": "gAAAAABk...",
    "phone": "gAAAAABk...",
    "ssn": "gAAAAABk..."
  },
  "meta": {
    "identifier": "req_1234567890abcdef",
    "encrypted_key": "AQICAHj...",
    "key_fingerprint": "arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012",
    "timestamp": "2024-01-01T00:00:00Z",
    "algorithm": "AES-256-GCM"
  }
}
```

</ResponseExample>

## Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `manifest_id` | string | Yes | UUID of the manifest to use for encryption |
| `data` | object | Yes | Data object containing fields to encrypt |

## Response Fields

### encrypted_data
Object containing the encrypted values for each field specified in the manifest.

### meta
Metadata required for decryption:

- `identifier`: Unique request identifier
- `encrypted_key`: AES key encrypted with KMS
- `key_fingerprint`: KMS key ARN used for encryption
- `timestamp`: ISO 8601 timestamp of encryption
- `algorithm`: Encryption algorithm used (AES-256-GCM)

## Error Responses

### Invalid Manifest

```json
{
  "error": "invalid_manifest",
  "message": "Manifest not found or inactive",
  "code": 400
}
```

### Invalid Data Format

```json
{
  "error": "invalid_data",
  "message": "Data format is invalid",
  "code": 400
}
```

### Missing Required Fields

```json
{
  "error": "missing_fields",
  "message": "Required fields missing from data",
  "code": 400
}
```

## Examples

### Basic Encryption

```javascript
const response = await fetch('https://api.cryptolay.com.br/api/encrypt', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'your_api_key'
  },
  body: JSON.stringify({
    manifest_id: 'manifest-uuid',
    data: {
      email: 'user@example.com',
      phone: '+1234567890'
    }
  })
});

const result = await response.json();
console.log(result.encrypted_data);
```

### Python Example

```python
import requests

response = requests.post(
    'https://api.cryptolay.com.br/api/encrypt',
    headers={
        'Content-Type': 'application/json',
        'X-API-Key': 'your_api_key'
    },
    json={
        'manifest_id': 'manifest-uuid',
        'data': {
            'email': 'user@example.com',
            'phone': '+1234567890'
        }
    }
)

result = response.json()
print(result['encrypted_data'])
```

## Security Notes

- All encryption uses AES-256-GCM with authenticated encryption
- Keys are generated per request and encrypted with AWS KMS
- Encrypted data is base64 encoded
- Store the `meta` object securely - it's required for decryption 